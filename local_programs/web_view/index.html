<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="UTF-8">
  <title>ROS Station-Keeping Simulation</title>

  <!-- Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/rxjs/7.3.0/rxjs.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDH2csoEoU0MN1xUvPrHK1MY2Gt4MfCFC8&callback=initMap" async defer></script>
  <script src="js/Controller.min.js"></script>

  <!-- JS/CSS -->
  <script src="js/main.js"></script>
  <link rel="stylesheet" href="css/custom.css" >

</head>

<body>
  <div id="container">  
    <div id="data-con">
      <div id="map"></div>
      <div id="data-vis">
        <div id="gps">
          <p>GPS Velocity:
            <ul>
              <li>x: <span id="gps_vel_x"></span></li>
              <li>y: <span id="gps_vel_y"></span></li>
            </ul>
            <canvas id="gps_vis" width="100" height="100" style="border:1px solid grey"></canvas>
          </p>
        </div>
        <div id="imu">
          <p>IMU:
            <ul>
              <li>Direction (z-rotation): <span id="imu_direction"></span></li>
              <li>Angular Velocity (z): <span id="imu_vel_z"></span></li>
            </ul>
            <canvas id="imu_vis" width="100" height="100" style="border:1px solid grey"></canvas>
          </p>
        </div>
        <div id="wind">
          <p>Wind:
            <ul>
              <li>Direction: <span id="wind_direction"></span></li>
              <li>Speed: <span id="wind_speed"></span></li>
            </ul>
            <canvas id="wind_vis" width="100" height="100" style="border:1px solid grey"></canvas>
          </p>
        </div>
        <div id="pose">
          <p>Pose Error:
            <ul>
              <li>Current: <span id="pose_error"></span></li>
              <li>Mean: <span id="pose_error_mean"></span></li>
            </ul>
          </p>
        </div>
        <div id="controls">
          <div id="thrusters">
            <p>
              <label>Thrusters</label>
              <input id="thruster" type="range" name="points" min="-2" max="2" step="0.25"/><span id="thruster_val"></span>
            </p>
          </div>
          <div id="rudders">
            <p>
              <label>Rudders</label>
              <input id="rudder" type="range" name="points" min="-1.5" max="1.5" step="0.1"/><span id="rudder_val"></span>
            </p>
          </div>
        </div>
      </div>
    </div>
    <div id="editor-con">
      <pre id="editor">/*
  This funciton will be run in a 1 second loop to move the boat.
  @param currentPos: { lat: float, lng: float } - The current position of the boat
  @param goalPos: { lat: float, lng: float} - The goal position
  @param currentVel: { x: float, y: float, z: float } - The boats current x and y velocity
  @param direction: float - The boats current heading (z-rotation)
  @param wind: { dir: float, speed: float } - Current direction and speed of wind
  @param err: { cur: float, mean: float } - Current error of boat from goal
*/
function move(currentPos, goalPos, currentVel, direction, wind, err){

}

// Don't touch
setInterval(() => {
    var vel = { 
        x: parseFloat(document.getElementById("gps_vel_x")),
        y: parseFloat(document.getElementById("gps_vel_y")),
        z: parseFloat(document.getElementById("imu_vel_z"))
    };
    var wind = {
        dir: parseFloat(document.getElementById("wind_direction")),
        speed: parseFloat(document.getElementById("wind_speed"))
    };
    var err = {
        cur: parseFloat(document.getElementById("pose_error")),
        mean: parseFloat(document.getElementById("pose_error_mean"))
    };
    move(marker.getPosition(),
         goal.getPosition(),
         vel,
         parseFloat(document.getElementById("imu_direction")), 
         wind,
         err);
}, 1000);</pre>
        <button id="run">Run</button>
        <button id="stop">Stop</button>
        <script src="js/ace/ace.js" type="text/javascript" charset="utf-8"></script>
        <script>
          var editor = ace.edit("editor");
          editor.setTheme("ace/theme/twilight");
          editor.session.setMode("ace/mode/javascript");
          document.getElementById("run").addEventListener('click', () => {
            eval(editor.getValue());
          });
          document.getElementById("stop").addEventListener('click', () => run = false);
        </script>
    </div>
</body>
</html>